<!--

=========================================================
* Now UI Kit - v1.3.0
=========================================================

* Product Page: https://www.creative-tim.com/product/now-ui-kit
* Copyright 2019 Creative Tim (http://www.creative-tim.com)
* Licensed under MIT (https://github.com/creativetimofficial/now-ui-kit/blob/master/LICENSE.md)

* Designed by www.invisionapp.com Coded by www.creative-tim.com

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="./assets/img/favicon.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    CinemaNut
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
  <!-- CSS Files -->
  <link href="./assets/css/bootstrap.min.css" rel="stylesheet" />
  <link href="./assets/css/now-ui-kit.css?v=1.3.0" rel="stylesheet" />
  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link href="./assets/demo/demo.css" rel="stylesheet" />

  <!-- Vue CDN -->
  <script src='https://cdn.jsdelivr.net/npm/vue@3.0.2/dist/vue.global.js'></script>
</head>

<body class="index-page sidebar-collapse">
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg bg-primary fixed-top navbar-transparent " color-on-scroll="400">
    <div class="container">
      <div class="navbar-translate">
        <!-- <a class="navbar-brand" href="https://demos.creative-tim.com/now-ui-kit/index.html" rel="tooltip" title="Designed by Invision. Coded by Creative Tim" data-placement="bottom" target="_blank"> -->
          CinemaNut
        <!-- </a> -->
        <!-- <button class="navbar-toggler navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-bar top-bar"></span>
          <span class="navbar-toggler-bar middle-bar"></span>
          <span class="navbar-toggler-bar bottom-bar"></span>
        </button> -->
      </div>
      <!-- <div class="collapse navbar-collapse justify-content-end" id="navigation" data-nav-image="./assets/img/blurred-image-1.jpg">
        <ul class="navbar-nav">
            <li class="nav-item">
              <a href="home.html" class="btn bg-danger nav-link btn-round">
                BROWSE
              </a>
            </li>
            <li class="nav-item">
              <a href="profile.html" class="btn bg-danger nav-link btn-round">
                PROFILE
              </a>
            </li>
            <li class="nav-item">
              <a href="login.html" class="btn bg-danger nav-link btn-round">
                REGISTER / LOGIN
              </a>
            </li>
        </ul>
      </div> -->
    </div>
  </nav>
  <!-- End Navbar -->
  <div id="app" class="wrapper">
    <div class="page-header clear-filter" filter-color="orange">
      <div class="page-header-image" data-parallax="true" style="background-color: black;">
      </div>
      <div class="container mx-6 px-5">
        <div class="row text-header text-center">
              <i>
                Already have an account? 
                <u>
                  <a href="login.html" class="text-center">
                    Login here.
                  </a>
                </u>
              </i>
            </div>
            <div class="row text-header text-center mb-4">
                  <div class="col pl-4" style="text-align: left;">
                    <h1>
                      Create an account
                    </h1>
                    <!-- <button type="button" class="btn btn-outline-light btn-round" data-toggle="modal" data-target="#uploadPhoto">Upload Photo</button> -->
                  </div>
            </div>
            <form>
                <div id="inputs">
                    <div class="form-group row">
                      <label for="full_name" class="category">
                        Full name:
                      </label>

                      <input v-model="full_name" type="text" id="full_name" class="form-control" placeholder="e.g. Jane Doe">

                      <label for="user_name" class="category mt-3">
                        Username:
                      </label>

                      <input v-model="user_name" type="text" id="user_name" class="form-control" placeholder="You won't be able to change this later!">

                      <label for="email" class="category mt-3">
                        Email:
                      </label>

                      <input v-model="email" type="text" id="email" class="form-control" placeholder="e.g. janedoe@gmail.com">

                      <label for="password" class="category mt-3">
                        Password:
                      </label>

                      <input v-model="password" type="password" id="password" class="form-control">

                      <label for="confirmPassword" class="category mt-3">
                        Confirm password:
                      </label>

                      <input v-model="confirm_password" type="password" id="confirmPassword" class="form-control" placeholder="Must match the password above.">

                      <div class="mt-3">
                        <button @click="register()" type="button" class="btn btn-primary btn-round">Register</button>
                      </div>
                    </div>
                </div>
            </form>
        </div>
        </div>
      </div>
    </div>
  </div>

    <script>
      const register_URL = "http://localhost:8000/user/register";
  
      const app = Vue.createApp({
          data() {
              return {
                full_name: "",
                user_name: "",
                email: "",
                password: "",
                confirm_password: "",
                error_msg: ""

              };
          },
          methods: {

            check_full_name () {
              if (this.full_name === "") {
                this.error_msg += "Please enter your name. "
              }
            },

            check_user_name () {
              if (this.user_name === "") {
                this.error_msg += "Please enter a username. "
              }
            },

            check_email () {
              if (!(this.email.includes("@")) || !(this.email.includes(".com"))) {
                this.error_msg += "Please enter a valid email (@/.com missing). "
              }
            },

            check_passwords () {
              if (this.password === "") { // check if pwd is entered
                this.error_msg += "Please enter a password. "
              }

              else if (this.password !== this.confirm_password){ // check if pwds match
                this.error_msg += "Passwords do not match. "
              }
            },

            register () { 
              console.log(this.full_name, this.user_name, this.email, this.password)

              this.check_full_name()
              this.check_user_name()
              this.check_email()
              this.check_passwords()

              if (this.error_msg !== "") { // check if any errors were caught in prev functions
                alert(this.error_msg)
                this.error_msg = ""
              }
              else {

                let jsonData = JSON.stringify({
                      user_name: this.user_name,
                      password: this.password,
                      full_name: this.full_name,
                      email: this.email
                  });
                console.log(typeof(jsonData))
                fetch(`${register_URL}`,
                      {
                          method: "POST",
                          headers: {
                              "Content-Type": "application/json"
                          },
                          body: jsonData
                      })
                      .then(response => response.json()
                      .then(data => {
                          console.log(data);
                          result = data.data;
                          console.log(result);
                            switch (data.code) {
                                case 201: // registration successful 
                                  window.location.href = "login.html" // redirect to login for Cookie to be created
                                    break;
                                case 400:
                                case 500:
                                    console.log(data.message);
                                    break;
                                default:
                                    throw `${data.code}: ${data.message}`;

                            }
                        }))
                window.location.href = "login.html" // redirect to login for Cookie to be created

              }

            }
          },
        }
      );

      const vm = app.mount('#app');
  </script>

  <!--   Core JS Files   -->
  <script src="./assets/js/core/jquery.min.js" type="text/javascript"></script>
  <script src="./assets/js/core/popper.min.js" type="text/javascript"></script>
  <script src="./assets/js/core/bootstrap.min.js" type="text/javascript"></script>
  <!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
  <script src="./assets/js/plugins/bootstrap-switch.js"></script>
  <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
  <script src="./assets/js/plugins/nouislider.min.js" type="text/javascript"></script>
  <!--  Plugin for the DatePicker, full documentation here: https://github.com/uxsolutions/bootstrap-datepicker -->
  <script src="./assets/js/plugins/bootstrap-datepicker.js" type="text/javascript"></script>
  <!--  Google Maps Plugin    -->
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>
  <!-- Control Center for Now Ui Kit: parallax effects, scripts for the example pages etc -->
  <script src="./assets/js/now-ui-kit.js?v=1.3.0" type="text/javascript"></script>
  <script>
    $(document).ready(function() {
      // the body of this function is in assets/js/now-ui-kit.js
      nowuiKit.initSliders();
    });

    function scrollToDownload() {

      if ($('.section-download').length != 0) {
        $("html, body").animate({
          scrollTop: $('.section-download').offset().top
        }, 1000);
      }
    }
  </script>
</body>

</html>